<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UserStore 测试</title>
  <script type="module">
    import { createApp, ref } from 'vue'
    import { useUserStore } from './src/utils/userStore.js'

    const app = createApp({
      setup() {
        const userStore = useUserStore()
        
        const testLogin = () => {
          console.log('=== 测试登录 ===')
          const testUser = {
            id: 1,
            username: 'testuser',
            email: 'test@example.com',
            avatar: 'http://localhost:8000/media/avatars/test.jpg'
          }
          
          localStorage.setItem('auth_token', 'test-token-123')
          userStore.setUser(testUser)
          
          console.log('登录后:')
          console.log('isAuthenticated:', userStore.isAuthenticated.value)
          console.log('username:', userStore.username.value)
          console.log('userAvatar:', userStore.userAvatar.value)
        }
        
        const testLogout = () => {
          console.log('=== 测试登出 ===')
          userStore.clearUser()
          
          console.log('登出后:')
          console.log('isAuthenticated:', userStore.isAuthenticated.value)
          console.log('username:', userStore.username.value)
          console.log('userAvatar:', userStore.userAvatar.value)
        }
        
        return {
          userStore,
          testLogin,
          testLogout
        }
      },
      template: `
        <div style="padding: 20px; font-family: sans-serif;">
          <h1>UserStore 响应式测试</h1>
          
          <div style="margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 8px;">
            <h3>当前状态：</h3>
            <p><strong>isAuthenticated:</strong> {{ userStore.isAuthenticated }}</p>
            <p><strong>username:</strong> {{ userStore.username }}</p>
            <p><strong>userEmail:</strong> {{ userStore.userEmail }}</p>
            <p><strong>userAvatar:</strong> {{ userStore.userAvatar }}</p>
            <p><strong>userInitial:</strong> {{ userStore.userInitial }}</p>
          </div>
          
          <div style="margin: 20px 0;">
            <button @click="testLogin" style="padding: 10px 20px; margin-right: 10px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">
              测试登录
            </button>
            <button @click="testLogout" style="padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">
              测试登出
            </button>
          </div>
          
          <div style="margin: 20px 0; padding: 15px; background: #e3f2fd; border-radius: 8px;">
            <h3>说明：</h3>
            <p>1. 点击"测试登录"按钮，上面的状态应该立即更新</p>
            <p>2. 点击"测试登出"按钮，上面的状态应该立即清空</p>
            <p>3. 打开浏览器控制台查看详细日志</p>
          </div>
        </div>
      `
    })
    
    app.mount('#app')
  </script>
</head>
<body>
  <div id="app"></div>
</body>
</html>

